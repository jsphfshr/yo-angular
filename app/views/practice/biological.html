<style>
.animate-enter {
    -webkit-transition: 1s linear all;
    /* Chrome */
    
    transition: 1s linear all;
    opacity: 0;
}
.animate-enter.animate-enter-active {
    opacity: 1;
}
.testresults_collapse {
    max-height: 100px;
    overflow: hidden;
}
</style>

<div class="hbox hbox-auto-xs hbox-auto-sm" ng-init="app.settings.asideFolded = false;app.settings.asideDock = false;">
    <div class='wrapper-md' ng-controller="biologicalCrtl">
        <div class="row wrapper-md" ng-if="!biological && biomessage" ng-show="loaded">There is no information item to display.</div>
        <div ng-show="!loaded" class='text-center'>
            <div style='margin-top: 100px; font-size: 12px; font-weight: bold'>LOADING</div>
            <br> <i class="fa fa-spinner text-lg"></i>
            <br>
        </div>
        <div class='col-lg-12' ng-if='biological' ng-show="loaded">
            <div class="row row-sm text-center">
                <!-- 	<div class="col-xs-1"> 
					<div class=" padder-v item ">
						<div class="inline m-t-sm">
							<div ui-jq="easyPieChart"
								ui-options="{
			                      percent: 70,
			                      lineWidth: 4,
			                      trackColor: '{{app.color.light}}',
			                      barColor: '{{app.color.primary}}',
			                      scaleColor: false,
			                      color: '#fff',  
			                      size: 60,   
			                      lineCap: 'butt',
			                      rotate: 0,
			                      animate: 1000
			                    }">
								<div>
									<span class="step" style='color: black;'>70 %</span>
								</div>
								<div>Score</div>
							</div>
						</div>  
					</div>
				</div> -->
                <div class="col-xs-12 col-md-4 col-lg-3">
                    <div class="panel padder-v item bg-info">
                        <div ng-if='biological.count.numberofautoclave == 0' class="h1 font-thin h1">No Autoclave </div>
                        <div ng-if='biological.count.numberofautoclave > 0' class="h1 font-thin h1">{{biological.count.numberofautoclave}}
                            <span ng-if='biological.count.numberofautoclave == 1'>autoclave</span>
                            <span ng-if='biological.count.numberofautoclave > 1'>autoclaves</span>
                        </div>
                        <span ng-if='biological.count.numberofautoclave == 0' class="text-xs">is registered in this practice</span>
                        <span ng-if='biological.count.numberofautoclave ==1' class="text-xs">is registered in this practice</span>
                        <span ng-if='biological.count.numberofautoclave > 1' class="text-xs">are registered in this practice</span>
                    </div>
                </div>
                <div class="col-xs-12 col-md-4 col-lg-3" is_missing='is_missing'>
                    <div ng-if='is_missing > 30' class="panel padder-v item bg-ot-warning">
                        <div class="h1 font-thin">Missing Testing</div>
                        <span class="text-xs">More than 30 days no testing is performed.</span>
                    </div>
                    <div ng-if='is_missing < 30' class="panel padder-v item bg-{{testcolor(biological.last_test_result)}}">
                        <div class="h1 font-thin">{{biological.last_test_result}}</div>
                        <span class="text-xs ">Last Test done on {{biological.last_activity}}</span>
                    </div>
                </div>
                <div ng-if='biological.count.unassignedtest > 0' class="col-xs-12 col-md-4 col-lg-3">
                    <div class="panel padder-v item bg-danger">
                        <div class="h1 font-thin h1">Unassigned</div>
                        <span class="text-xs">{{biological.count.unassignedtest}} results not assign to any
								autoclave </span>
                        <br>
                    </div>
                </div>
            </div>
        </div>
        <!-- list autoclave -->
        <div ng-repeat="autoclave in biological.autoclaves">
            <!-- <div class="col-lg-12 wrapper-md"> -->
            <div class="panel b-a col-lg-8 wrapper-md">
                <div class="panel-heading  row">
                    <!-- Unassined test result test title -->
                    <div ng-if="autoclave.id == 0" class='m-t-md text-ot-warning  text-center font-bold'>Unassigned Test Results ({{ biological.count.unassignedtest}})</div>
                    <!-- /Unassined test result test title -->
                    <div class="" ng-if="autoclave.id !=0">
                        <a href="" class="pull-left thumb-md avatar b-3x m-r"> <img src="images/img/autoclave.jpg" alt="...">
                        </a>
                        <div class='clear font-bold col-lg-4'>
                            <div>
                                <span ng-show="autoclave.serial" class="h4">{{autoclave.name}}</span>
                            </div>
                            <div>
                                <span ng-show="autoclave.serial" class="text-muted">Serial#:
											{{autoclave.serial}}</span>
                            </div>
                            <div>
                                <span ng-show="autoclave.type" class="text-muted">Type:
											{{autoclave.type}}</span>
                            </div>
                            <div>
                                <span ng-show="autoclave.brand" class=" text-muted">Brand:
											{{autoclave.brand}}</span>
                            </div>
                            <div>
                                <span ng-if="autoclave.model" class="text-muted">Model:
											{{autoclave.model}}</span>
                            </div>
                            <div>
                                <span ng-if="autoclave.is_active =='Active'" class=" text-success">Active</span> <span ng-if="autoclave.is_active =='Inactive'" class=" text-danger">Inactive</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4" ng-show="autoclave.is_active =='Active'">
                        <div ng-if="autoclave.testStatus" class="text-{{autoclave.testStatus}}">
                            <span class="font-bold"> Latest test was done on
										{{autoclave.lastactivity}} ({{autoclave.lasttestresult}})
									</span>
                            <br>
                            <span ng-if="autoclave.testStatus == 'danger'">It has been more than 45
										days no test is performed.</span>
                            <span ng-if="autoclave.testStatus == 'ot-warning'">It
										has been more than 30 days no test is performed.</span>
                        </div>

                    </div>
                    <div class="thumb-sm pull-right" ng-if="autoclave.testStatus">
                        <div ng-show="autoclave.testStatus !='success'" class="text-{{autoclave.testStatus}}">
                            <span><i class="glyphicon glyphicon-warning-sign"></i></span>
                        </div>
                        <div ng-show="autoclave.testStatus =='success'" class="text-{{autoclave.testStatus}}">
                            <span><i class="glyphicon glyphicon-check"></i></span>
                        </div>
                    </div>
                </div>
                <div class="text-center  m-t-n-sm pull-right" ng-if="autoclave.testresults.length > 2">
                    <a ng-click="autoclave.collapsed = !autoclave.collapsed" class="text-info"> <span ng-if="autoclave.collapsed" class='m-r-xs m-t-sm'>Show all</span> <span ng-if="!autoclave.collapsed" class='m-r-xs m-t-sm'>Hide</span>
                    </a>
                </div>
                <hr>
                <div id='testresultdiv' ng-class="{'testresults_collapse':autoclave.collapsed}">
                    <table class="table table-striped m-b-none">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Test Done By</th>
                                <th>Test Date</th>
                                <th>Result</th>
                                <th>Test Type</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="testresult in autoclave.testresults">
                                <td><i class="fa fa-circle pull-left text-ot-xs m-t-xs text-{{testcolor(testresult.test_result)}}"></i>
                                </td>
                                <td>{{testresult.test_operator}}</td>
                                <td>{{testresult.test_date}}</td>
                                <td ng-switch on='testresult.addressed_on'>{{testresult.test_result}} &nbsp;
                                    <span ng-switch-when=" " class="text-danger" ng-if='(testresult.test_result != "Pass")' title="No corrective action is entered.">(Not addressed) <i class="fa fa-info-circle"></i></span>
                                    </span>
                                    <span ng-switch-default class="text-muted" ng-if='testresult.test_result != "Pass"' title="Addressed on: {{testresult.addressed_on}} &#10;{{testresult.note}}">(addressed) <i class="fa fa-info-circle"></i>
											</span>
                                </td>
                                <td>{{testresult.test_type}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="text-center m-t-sm m-b-xs" ng-if="autoclave.testresults.length > 2">
                    <a ng-click="autoclave.collapsed = !autoclave.collapsed" class="text-info"> <span ng-if="autoclave.collapsed">Show all</span> <span ng-if="!autoclave.collapsed">Hide</span>
                    </a> <a ng-if="!autoclave.collapsed" href ui-scroll="app" class="m-t-xs m-r-md pull-right"><i class="icon-arrow-up"></i></a>
                </div>
                <!-- </div> -->
            </div>
        </div>
    </div>
</div>
